library("ggplot2")

heights <- c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100)
heights_all <- c(heights,heights)

method_lewos <- c()
method_fsct <- c()
for (i in seq(0,100,by=1)){
  method_lewos <- c(method_lewos, "lewos_dbscan")
  method_fsct <- c(method_fsct, "fsct")
}
method_all <- c(method_lewos,method_fsct)

v_lewos_dbscan_acc <- c(1.0,0.6186666666666667,0.9519368723098995,0.9079355238685679,0.9507364144235653,0.927434456928839,0.8470467736428815,0.8973509933774835,0.9048165137614679,0.6445115810674723,0.8388888888888889,0.6695402298850575,0.8661590524534687,0.7072192513368984,0.7754785307811691,0.8480278422273781,0.7496758986446671,0.665443104352386,0.7333887043189369,0.684931506849315,0.7104773713577185,0.7344896597731821,0.6457605589075898,0.6563677467972872,0.6900630914826499,0.7340637450199203,0.6278855032317636,0.723175965665236,0.626,0.6179391682184978,0.5561023622047244,0.5088797814207651,0.5198744769874477,0.6489533011272142,0.5963559915907498,0.5547309833024119,0.6331360946745562,0.6183574879227053,0.5972602739726027,0.6032786885245902,0.5463347164591977,0.5222841225626741,0.5254237288135594,0.5282555282555282,0.5555555555555556,0.500542888165038,0.48658823529411765,0.5392561983471075,0.5166666666666667,0.5057034220532319,0.5,0.47071277346506707,0.4879154078549849,0.43687374749499,0.45043731778425655,0.5013301803133313,0.48314606741573035,0.4200332042058661,0.45077720207253885,0.574468085106383,0.4747252747252747,0.3865546218487395,0.38771466314398945,0.4882544271774485,0.39313984168865435,0.5176991150442478,0.3878481012658228,0.5745393634840871,0.48332097850259453,0.38686131386861317,0.45698924731182794,0.4578313253012048,0.3364140480591497,0.5713305898491083,0.2547642928786359,0.5338491295938105,0.2569444444444444,0.6101895734597157,0.406025824964132,0.20238095238095238,0.43264897346019027,0.6416861826697893,0.3884595569294178,0.7022955523672884,0.15938303341902313,0.23106796116504855,0.46458333333333335,0.12099644128113879,0.1182108626198083,0.3551491819056785,0.09473684210526316,0.6180758017492711,0.8013245033112583,0.7863636363636364,0.6014285714285714,0.08907363420427554,0.6794117647058824,0.8507462686567164,0.13713592233009708,0.9940828402366864,0.0)
v_fsct_acc <- c(1.0,0.9866666666666667,0.9791965566714491,0.962802231866088,0.9507364144235653,0.9466292134831461,0.8914305223625811,0.9266792809839167,0.911697247706422,0.9003021148036254,0.8951851851851852,0.8706896551724138,0.8749576988155668,0.8683155080213903,0.8647180548370409,0.8480278422273781,0.8318208603417796,0.8290508652333508,0.8106312292358804,0.8082191780821918,0.7904525728456293,0.7885256837891927,0.7789774531597332,0.7671439336850038,0.751577287066246,0.7450199203187251,0.7349953831948292,0.723175965665236,0.712,0.9089075108628182,0.6948818897637795,0.6898907103825137,0.6799163179916318,0.6674718196457327,0.6562718990889979,0.6408163265306123,0.6331360946745562,0.6280193236714976,0.6109589041095891,0.6032786885245902,0.5975103734439834,0.5877437325905293,0.5766747376916869,0.5470925470925471,0.5555555555555556,0.5494028230184582,0.5397647058823529,0.5289256198347108,0.5166666666666667,0.5019011406844106,0.5,0.48694424841213835,0.4788519637462236,0.46292585170340683,0.4518950437317784,0.44871415903044637,0.4307116104868914,0.4194798007747648,0.41968911917098445,0.40425531914893614,0.3912087912087912,0.3865546218487395,0.3725231175693527,0.36248644741597397,0.35356200527704484,0.3445006321112516,0.3331645569620253,0.32663316582914576,0.3172720533728688,0.30656934306569344,0.29301075268817206,0.2891566265060241,0.2735674676524954,0.2606310013717421,0.2547642928786359,0.2205029013539652,0.2361111111111111,0.22274881516587677,0.21377331420373027,0.20238095238095238,0.33400100150225337,0.18969555035128804,0.17619783616692428,0.16140602582496413,0.15938303341902313,0.1436893203883495,0.13958333333333334,0.302491103202847,0.2055378061767838,0.1039461020211742,0.10526315789473684,0.08843537414965986,0.08885209713024282,0.06363636363636363,0.05142857142857143,0.048693586698337295,0.039705882352941174,0.029850746268656716,0.010922330097087379,0.005917159763313609,0.0)
acc_all <- c(v_lewos_dbscan_acc, v_fsct_acc)

v_lewos_dbscan_spe <- c(1.0,0.6243243243243243,0.9706959706959707,0.9401159047005795,1.0,0.9797230464886251,0.9074889867841409,0.967330270546197,0.9916142557651991,0.685682326621924,0.927596193628465,0.737785016286645,0.9887836008508992,0.7867590454195535,0.8853599516031458,1.0,0.8744686880136016,0.7526881720430108,0.8647540983606558,0.815442561205273,0.8509803921568627,0.9082064297800339,0.7789795918367347,0.8005893909626719,0.8835257082896117,0.9732620320855615,0.7437185929648241,1.0,0.7724719101123596,0.7655766681396377,0.669971671388102,0.5207920792079208,0.5584615384615385,0.9264173703256936,0.803523758675921,0.7747539085118703,1.0,0.9692307692307692,0.9260089686098655,1.0,0.8171296296296297,0.6255924170616114,0.6648005598320503,0.7021897810218978,1.0,0.6818181818181818,0.6512641673931997,0.9765625,1.0,0.8257575757575758,0.0,0.7231884057971014,0.9716088328075709,0.6623376623376623,0.9096774193548387,0.7187088274044796,0.7565217391304347,1.0,0.8271604938271605,0.42105263157894735,0.4606741573033708,1.0,0.9964539007092199,0.5902293120638086,0.8582089552238806,0.41284403669724773,0.8875379939209727,0.21025641025641026,0.5186915887850467,0.7952755905511811,0.555045871559633,0.75,0.9121621621621622,0.39473684210526316,1.0,0.5433070866141733,1.0,0.2712765957446808,0.5469798657718121,1.0,0.4897435897435897,0.25925925925925924,0.7134502923976608,0.19555555555555557,1.0,0.6891891891891891,0.43283582089552236,1.0,1.0,0.5833333333333334,1.0,0.42857142857142855,0.2440944881889764,0.14285714285714285,0.4444444444444444,0.9512195121951219,0.3333333333333333,0.0,0.3333333333333333,0.0,NA)
v_fsct_spe <- c(1.0,1.0,1.0,1.0,1.0,1.0,0.9577826725403817,1.0,1.0,1.0,1.0,0.9869706840390879,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9980114891736632,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9605839416058394,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9986824769433466,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9921259842519685,1.0,1.0,1.0,1.0,1.0,0.8582677165354331,1.0,1.0,1.0,1.0,0.9974358974358974,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9819819819819819,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,NA)
spe_all <- c(v_lewos_dbscan_spe, v_fsct_spe)

v_lewos_dbscan_rec <- c(NA,0.2,0.06896551724137931,0.075,0.0,0.0,0.04390243902439024,0.012903225806451613,0.008658008658008658,0.2727272727272727,0.0812720848056537,0.15853658536585366,0.008119079837618403,0.18274111675126903,0.12678571428571428,0.0,0.1324456902592852,0.24233128834355827,0.17105263157894737,0.1349206349206349,0.1804733727810651,0.08675078864353312,0.17882689556509299,0.18122977346278318,0.10476190476190476,0.03515625,0.30662020905923343,0.0,0.2638888888888889,0.26955161626694474,0.2967741935483871,0.48237885462555063,0.43790849673202614,0.09200968523002422,0.20081549439347604,0.1621900826446281,0.0,0.025974025974025976,0.08098591549295775,0.0,0.14432989690721648,0.375,0.33555767397521447,0.30597014925373134,0.0,0.27951807228915665,0.2934560327198364,0.04824561403508772,0.0,0.183206106870229,1.0,0.2310866574965612,0.043478260869565216,0.24253731343283583,0.07180851063829788,0.32439678284182305,0.27631578947368424,0.0,0.17857142857142858,0.6785714285714286,0.48375451263537905,0.0,0.02631578947368421,0.4302721088435374,0.13877551020408163,0.5728061716489875,0.13819286256643887,0.7512437810945274,0.46688382193268185,0.20422535211267606,0.41634980988593157,0.3389830508474576,0.11959287531806616,0.6335807050092764,0.0,0.5307692307692308,0.02727272727272727,0.7073170731707317,0.3677007299270073,0.0,0.4187927815805849,0.7312138728323699,0.31894934333958724,0.7998289136013687,0.0,0.15419501133786848,0.46973365617433416,0.0,0.0,0.32867883995703545,0.0,0.6364605543710021,0.8433234421364986,0.8300970873786407,0.6099397590361446,0.0449438202247191,0.6937212863705973,0.8769230769230769,0.13496932515337423,1.0,0.0)
v_fsct_rec <- c(NA,0.0,0.0,0.0,0.0,0.0,0.00975609756097561,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.06607142857142857,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.004291845493562232,0.0,0.0,0.0,0.0,0.0,0.0,0.6986444212721585,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.018656716417910446,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.01282051282051282,0.0,0.0,0.0,0.0,0.1729931549471064,0.0,0.0,0.0,0.0,0.0,0.0,0.20647773279352227,0.10144927536231885,0.0,0.011627906976744186,0.0,0.020178041543026708,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
rec_all <- c(v_lewos_dbscan_rec, v_fsct_rec)

v_lewos_dbscan_acc <- v_lewos_dbscan_acc[!is.nan(v_lewos_dbscan_acc)]
v_lewos_dbscan_spe <- v_lewos_dbscan_spe[!is.nan(v_lewos_dbscan_spe)]
v_lewos_dbscan_rec <- v_lewos_dbscan_rec[!is.nan(v_lewos_dbscan_rec)]
v_fsct_acc <- v_fsct_acc[!is.nan(v_fsct_acc)]
v_fsct_spe <- v_fsct_spe[!is.nan(v_fsct_spe)]
v_fsct_rec <- v_fsct_rec[!is.nan(v_fsct_rec)]

ci_lewos_acc <- (sd(v_lewos_dbscan_acc) * 1.96)/(length(v_lewos_dbscan_acc)**0.5)
ci_lewos_spe <- (sd(v_lewos_dbscan_spe) * 1.96)/(length(v_lewos_dbscan_spe)**0.5)
ci_lewos_rec <- (sd(v_lewos_dbscan_rec) * 1.96)/(length(v_lewos_dbscan_rec)**0.5)
cat("ci_lewos_acc=",ci_lewos_acc,'\n')
cat("ci_lewos_spe=",ci_lewos_spe,'\n')
cat("ci_lewos_rec=",ci_lewos_rec,'\n')

ci_fsct_acc <- (sd(v_fsct_acc) * 1.96)/(length(v_fsct_acc)**0.5)
ci_fsct_spe <- (sd(v_fsct_spe) * 1.96)/(length(v_fsct_spe)**0.5)
ci_fsct_rec <- (sd(v_fsct_rec) * 1.96)/(length(v_fsct_rec)**0.5)
cat("ci_fsct_acc=",ci_fsct_acc,'\n')
cat("ci_fsct_spe=",ci_fsct_spe,'\n')
cat("ci_fsct_rec=",ci_fsct_rec,'\n')


nb_pts <- c(554,375,1394,3226,1969,2136,2929,2114,2616,993,2700,696,5910,1496,3866,862,8485,1907,1204,657,3226,2998,6298,1327,1268,1004,1083,466,500,6444,1016,1464,956,2484,2854,2695,169,414,730,305,723,718,2478,1221,9,921,2125,968,60,263,2,1417,662,499,686,3383,267,1807,193,47,455,357,1514,2767,379,1582,1975,597,1349,411,744,581,541,1458,997,517,144,844,1394,168,1997,427,1941,1394,778,515,480,281,939,1039,190,1029,1812,220,700,1684,680,67,824,169,53)
nb_pts_all <- c(nb_pts, nb_pts)

df <- data.frame(Height=heights_all, Method=method_all, Accuracy=acc_all, Specificity=spe_all, Recall=rec_all, NbPts=nb_pts_all)
df

df_bis <- data.frame(Height = heights, NbPts=nb_pts)
df_bis
# Accuracy
p_acc<- ggplot(df, aes(x = Height, y = Accuracy, colour = Method)) +
  geom_line(lwd=.7) +
  geom_ribbon(data=df[df$Method=="lewos_dbscan",], aes(ymin = Accuracy - ci_lewos_acc, ymax = Accuracy+ ci_lewos_acc), 
              alpha = .3, fill = "darkseagreen3", color = "transparent") +
  geom_ribbon(data=df[df$Method=="fsct",], aes(ymin = Accuracy - ci_fsct_acc, ymax = Accuracy+ ci_fsct_acc), 
              alpha = .3, fill = "darkorange1", color = "transparent") +
  labs(x = "Wooden points proportion %", y = "Accuracy (95% CI)") +
  ylim(-0.15,1.15)+
  scale_color_manual(name = "Method", values =c('lewos_dbscan'='aquamarine4','fsct'='chocolate3'), labels = c('fsct','lewos')) + 
  coord_flip() +
  theme(text = element_text(size=15), axis.text=element_text(size=12), legend.title = element_text(size=15), legend.text = element_text(size=14))
p_acc

# Specificity
p_spe<- ggplot(df, aes(x = Height, y = Specificity, colour = Method)) +
  geom_line(lwd=.7) +
  geom_ribbon(data=df[df$Method=="lewos_dbscan",], aes(ymin = Specificity - ci_lewos_spe, ymax = Specificity+ ci_lewos_spe), 
              alpha = .3, fill = "darkseagreen3", color = "transparent") +
  geom_ribbon(data=df[df$Method=="fsct",], aes(ymin = Specificity - ci_fsct_spe, ymax = Specificity+ ci_fsct_spe), 
              alpha = .3, fill = "darkorange1", color = "transparent") +
  labs(x = "Wooden points proportion %", y = "Specificity (95% CI)") +
  ylim(-0.15,1.15)+
  scale_color_manual(name = "Method", values =c('lewos_dbscan'='aquamarine4','fsct'='chocolate3'), labels = c('fsct','lewos')) + 
  coord_flip() +
  theme(text = element_text(size=15), axis.text=element_text(size=12), legend.title = element_text(size=15), legend.text = element_text(size=14))
#p_spe

# Recall
p_rec<- ggplot(df, aes(x = Height, y = Recall, colour = Method)) +
  geom_line(lwd=.7) +
  geom_ribbon(data=df[df$Method=="lewos_dbscan",], aes(ymin = Recall - ci_lewos_rec, ymax = Recall+ ci_lewos_rec), 
              alpha = .3, fill = "darkseagreen3", color = "transparent") +
  geom_ribbon(data=df[df$Method=="fsct",], aes(ymin = Recall - ci_fsct_rec, ymax = Recall+ ci_fsct_rec), 
              alpha = .3, fill = "darkorange1", color = "transparent") +
  labs(x = "Wooden points proportion %", y = "Recall (95% CI)") +
  ylim(-0.15,1.15)+
  scale_color_manual(name = "Method", values =c('lewos_dbscan'='aquamarine4','fsct'='chocolate3'), labels = c('fsct','lewos')) + 
  coord_flip() +
  theme(text = element_text(size=15), axis.text=element_text(size=12), legend.title = element_text(size=15), legend.text = element_text(size=14))
#p_rec
my_list <- list("acc" = p_acc, "spe" = p_spe, "rec" = p_rec)

my_list$acc
my_list$spe
my_list$rec

ci_NbPts <- (sd(nb_pts) * 1.96)/(length(nb_pts)**0.5)
p1<- ggplot(df_bis, aes(x = Height, y = NbPts)) +
  geom_ribbon(aes(ymin = NbPts - ci_NbPts, ymax = NbPts+ ci_NbPts), 
              alpha = .3, fill = "darkseagreen3", color = "transparent") +
  geom_line(color = "aquamarine4", lwd=.7) +
  labs(x = "Wooden points proportion %", y = "NbPts") +
  coord_flip()
p1
